<!DOCTYPE html>
{% load leaflet_tags %}
{% load dictionary_extras %}
{% load splitter %}
{% load static %}

<html>

    <head>
        <title>NewsMiner+</title>
        <link rel="stylesheet" type="text/css" href="{% static "css/main.css" %}">
        
        {% leaflet_js %}
        {% leaflet_css %}
		<link rel="stylesheet" href="../dist/leaflet.label.css" />
		
    </head>

    <body>
    	<header>
			<h1><a href="/">NewsMiner+</a></h1>
    	</header>
		<nav>
			<ul>
				<li><a href='{% url 'what' %}'>What is NewsMiner+?</a></li>
				<li><a href='{% url 'impressum' %}'>Impressum</a></li>
			</ul>
		</nav>
		<div id='wrapper'>
    	<section>
			{% for article in articles %}
			<article>
				<h2 class="article_title">{{article.title}}</h2>
				<p>
					{{article.description}}
				</p>
				<br />
				<div id="{{article.link}}" class="article_text" style="display:none">
					{% for word in article.text|split:' ' %}
						{% if word in location_match.keys %}
							<div id="map-navigation" class="map-navigation">
								<a href="#" data-zoom="12" data-position="{{location_match|access:word|access:'lat'}},{{location_match|access:word|access:'lng'}}">{{word}}</a>
							</div>
						{% else %}
							{{word}}
						{% endif %}
					{% endfor %}	
				</div>
				<a href="#{{article.link}}" onclick="javascript:showHide('{{article.link}}');"> [read more...]
					</a>
			</article>
			{% endfor %}
		</section>	
		<a href='{% url 'index' %}'>
		<footer>
			EXIT
		</footer>
		</a>
		</div>	
		<aside>
			<div class="widget">
    			{% leaflet_map "yourmap" callback="window.map_init_basic" creatediv="True"%}	
			</div>	
    	{% for widget in widgets %}
    		<div class="widget">
    			widget area
    		</div>
    		{% endfor %}
    		<div class="custom_widget">
    			custom widget area
    		</div>
		</aside>
	<script src="{% static "js/Label.js" %}"></script>
	<script src="{% static "js/BaseMarkerMethods.js" %}"></script>
	<script src="{% static "js/Marker.Label.js" %}"></script>
	<script src="{% static "js/Map.Label.js" %}"></script>
	
	<script type="text/javascript" charset="utf-8">
	  	function showHide(elementid){
	    	if (document.getElementById(elementid).style.display == 'none'){
	      		document.getElementById(elementid).style.display = '';
	    	} else {
	      		document.getElementById(elementid).style.display = 'none';
	    	}
	  	}
    	function changeContent(id, msg) {
     		var el = document.getElementById(id);
    		if (id) {
    			el.innerHTML = msg;
    		}
    	}
    	
    	function focusLocation(latitude, longitude) {
    		var newCenter = L.latLng(latitude, longitude);
        	map.panTo(newCenter)
    	}
    	function map_init_basic (map, options) {
    		{% for location in locations %}
        	L.marker([{{location.latlng.0}},  {{location.latlng.1}}]).bindLabel("{{location.name}}", { noHide: false })
        	.addTo(map);
        	{% endfor %}
        	var center = L.latLng({{map_center.0}}, {{map_center.1}});
        	map.panTo(center);
        	document.getElementById('map-navigation').onclick = function(e) {
        	    var pos = e.target.getAttribute('data-position');
        	    var zoom = e.target.getAttribute('data-zoom');
        	    if (pos && zoom) {
        	        var loc = pos.split(',');
        	        var z = parseInt(zoom);
        	        map.setView(loc, z, {animation: true});
        	        return false;
        	    }
        	}
    	}
	</script>
    </body>
</html>